# Анализ гипотезы "Акустический аудит"

**Дата:** 2026-01-30
**Статус:** Исследование завершено

---

## Суть проблемы

Ошибки с короткими словами (и/а/я) сложно классифицировать:
- **9 golden** ошибок связаны с и/а/я
- **49 "реальных"** ошибок с и/а/я в filtered.json (могут быть FP)
- **8 отфильтрованных** как Яндекс-ошибки

---

## Эмпирические данные

### Анализ 9 golden ошибок с и/а/я

| # | Глава | Время | Тип | Ошибка | Пауза | Conf | Паттерн |
|---|-------|-------|-----|--------|-------|------|---------|
| 1 | 1 | 12:40 | deletion | -я | **0.96s** | 1.00 | ЯВНЫЙ ПРОПУСК |
| 2 | 1 | 25:36 | subst | с→я | 0.06s | 1.00 | слитная речь |
| 3 | 1 | 30:38 | subst | и→или | **0.44s** | 1.00 | ЯВНЫЙ ПРОПУСК |
| 4 | 1 | 31:00 | subst | и→а | **0.45s** | 1.00 | ЯВНЫЙ ПРОПУСК |
| 5 | 3 | 3:55 | insertion | +и | 0.10s | 1.00 | слитная речь |
| 6 | 3 | 12:55 | insertion | +и | **0.38s** | 1.00 | ЯВНЫЙ ПРОПУСК |
| 7 | 3 | 29:00 | subst | я→и | **0.47s** | 1.00 | ЯВНЫЙ ПРОПУСК |
| 8 | 3 | 37:08 | insertion | +и | 0.08s | 1.00 | слитная речь |
| 9 | 3 | 48:58 | insertion | +и | 0.04s | 1.00 | слитная речь |

### Ключевые наблюдения

1. **Confidence всегда = 1.00** — этот параметр не помогает различить типы ошибок
2. **Пауза — ключевой индикатор:**
   - Пауза > 0.3s → 5 из 5 = реальные ошибки (100%)
   - Пауза < 0.15s → 4 из 4 = слитная речь (100%)

3. **Но ВСЕ 9 — это golden (реальные ошибки чтеца!):**
   - Даже "слитная речь" — это реальные ошибки
   - Акустический анализ **НЕ ПОМОГАЕТ** отличить golden от FP

---

## Критический вывод

### Проблема гипотезы

**Гипотеза предполагала:**
- Большая пауза = реальный пропуск чтеца
- Маленькая пауза = Яндекс проглотил букву (FP)

**Реальность:**
- ВСЕ 9 golden — реальные ошибки чтеца
- Из них 4 имеют маленькую паузу (< 0.15s)
- Если фильтровать по паузе < 0.15s — **потеряем 4 golden ошибки!**

### Почему так происходит?

Ошибки с маленькой паузой:
- **Гл.1 25:36 с→я** — чтец сказал "я" вместо "с" (замена, не пропуск)
- **Гл.3 3:55 +и** — чтец ДОБАВИЛ лишнее "и" (вставка)
- **Гл.3 37:08 +и** — чтец ДОБАВИЛ лишнее "и"
- **Гл.3 48:58 +и** — чтец ДОБАВИЛ лишнее "и"

Это **вставки чтеца**, а не пропуски Яндекса. Маленькая пауза — потому что слово реально произнесено.

---

## Пересмотр стратегии

### Что НЕ работает

| Метод | Проблема |
|-------|----------|
| Silence Gap Analysis | Отфильтрует 4 golden (insertion) |
| Confidence-based | Confidence = 1.0 везде, не помогает |

### Что МОЖЕТ работать

1. **Грамматический контекст** (Grammar Expectation):
   - "Я" + глагол 1-го лица = ожидаемый паттерн
   - Если "я" пропало перед "обернулся" — это важно

2. **Типизация по направлению ошибки:**
   - deletion "я" — часто реальный пропуск
   - insertion "и" — часто ошибка Яндекса
   - substitution и↔я — требует контекста

3. **Семантический контекст:**
   - "и" между существительными = связка (легко пропустить)
   - "я" в начале предложения = подлежащее (важно)

---

## Альтернативное предложение

### Вместо акустического анализа — контекстный анализ

```python
def analyze_short_word_error(error, context):
    """
    Анализ ошибок с и/а/я на основе контекста.
    """
    word = (error.get('original') or error.get('transcript') or '').lower()
    error_type = error.get('type')

    # Правило 1: deletion "я" перед глаголом = важно
    if error_type == 'deletion' and word == 'я':
        next_word_pos = get_pos(context['next_word'])
        if next_word_pos == 'VERB':
            return 90, 'deletion_я_before_verb'

    # Правило 2: insertion "и" между словами одного типа = возможно FP
    if error_type == 'insertion' and word == 'и':
        prev_pos = get_pos(context['prev_word'])
        next_pos = get_pos(context['next_word'])
        if prev_pos == next_pos == 'NOUN':
            return 30, 'insertion_и_between_nouns'

    # Правило 3: substitution и↔я = требует проверки
    if error_type == 'substitution':
        return 50, 'substitution_needs_review'

    return 50, 'unknown'
```

### Преимущества

1. Не зависит от акустики
2. Работает на уровне сравнения текстов
3. Не требует доступа к сырой транскрипции

---

## Итоговые рекомендации

### НЕ внедрять

- Silence Gap Analysis — потеряем 4 golden
- Confidence-based Filtering — confidence = 1.0 везде

### МОЖНО внедрить (опционально)

- Grammar Expectation — морфологический анализ контекста
- Но это **низкий приоритет** — текущая система уже ловит все 9 golden

### Текущее состояние

**Система работает корректно:**
- Все 9 golden с и/а/я находятся в filtered.json
- Фильтрация не теряет реальные ошибки

**Проблема:**
- 49 "реальных" ошибок с и/а/я — часть из них может быть FP
- Но лучше FP, чем потеря golden

---

## Финальный вывод

**Гипотеза "Акустический аудит" НЕ ПОДТВЕРДИЛАСЬ.**

Причины:
1. Confidence = 1.0 для всех слов — не информативен
2. Пауза коррелирует с типом ошибки, но не с её реальностью
3. Фильтрация по паузе приведёт к потере 4 golden ошибок (insertion)

**Рекомендация:** Оставить текущую логику без изменений.

---

## Данные для справки

### Структура транскрипции Яндекса

```json
{
  "chunks": [{
    "alternatives": [{
      "words": [{
        "word": "обернулся",
        "startTime": "760.56s",
        "endTime": "761.12s",
        "confidence": 1.0
      }]
    }]
  }]
}
```

### Пример анализа (Гл.1 12:40, deletion -я)

```
758.96-759.60s: 'умолчать' (conf=1.00)
[ПАУЗА 0.959s]
760.56-761.12s: 'обернулся' (conf=1.00)

Оригинал: "...умолчать. Я обернулся..."
Транскрипт: "...умолчать. Обернулся..."

Вывод: Пауза почти 1 секунда — чтец реально не произнёс "Я".
Это golden ошибка, система её правильно нашла.
```

---

*Анализ завершён: 2026-01-30*
*Результат: гипотеза отклонена*
