# Changelog

> Полная детальная история: `Документация/Архив/CHANGELOG_FULL.md`

## [11.1.0] - 2026-01-30 — Текущая версия

**SmartFilter v3.0** — исправленная логика весов.

| Метрика | До (v10.7) | После |
|---------|------------|-------|
| Golden | 93/93 | **93/93** ✓ |
| FP | 262 | 268 (+6) |

КЛЮЧЕВОЕ ИЗМЕНЕНИЕ:
- Одинаковая лемма НЕ означает FP!
- Грамматические различия (число, падеж, вид, POS) = РЕАЛЬНАЯ ошибка

Новые модули:
- `smart_scorer.py` v3.0 — накопительный скоринг с `grammar_change` (+70)
- `smart_filter.py` v3.0 — детекция грамм. различий + pymorphy3
- `frequency_manager.py` v1.0 — частотный словарь НКРЯ
- `sliding_window.py` v1.0 — фонетическое сравнение

Исправления:
- Убраны ошибочные штрафы: `same_lemma`, `phonetic_similar_weak`
- Добавлена детекция приставки "по-" (побольше→больше)

---

## [10.7.0] - 2026-01-29

**safe_ending_transition** — новый фильтр на основе анализа БД.

| Метрика | До | После |
|---------|-----|-------|
| Golden | 93/93 | 93/93 ✓ |
| FP | 324 | **262** |
| FP Recall | 64.1% | **72.3%** |

Изменения:
- `engine.py` v8.6.0 — фильтр безопасных переходов окончаний
- `false_positives_db.py` v3.1 — исправлен mark_golden()

---

## [10.5.0] - 2026-01-29

**Унификация версионирования** — метаданные версий в JSON.

- Метаданные в compared.json: `created_at`, `smart_compare_version`
- Валидация версий в engine.py
- Флаг `--clean` в run_full_test.py
- FP: 328 → 309

---

## [10.0.0] - 2026-01-29

**Посегментное выравнивание** — полный переход от полнотекстового сравнения.

- `compare_with_anchors()` — сравнение с якорями
- `refine_large_segments()` — суб-якоря для сегментов >100 слов
- AlignmentManager v1.2 — фильтр монотонности

---

## [9.0.0] - 2026-01-29

**Модульная архитектура** — 6 независимых модулей.

Модули:
- AlignmentManager — макро-выравнивание
- WindowVerifier — контекстная верификация
- ScoringEngine — адаптивные штрафы
- ComparisonStitcher — склейка слов
- MorphoRules — морфологические правила
- CharacterGuard — защита имён

---

## [8.0.0] - 2026-01-26

**Консервативная фильтрация** — при сомнении НЕ фильтруем.

- morpho_rules.py — единый морфологический модуль
- 20+ уровней фильтрации в engine.py
- Golden 94/94 (100%)

---

## [5.7.0] - 2026-01-25 — Лучший исторический FP

| Глава | Golden | FP |
|-------|--------|-----|
| 1 | 31/31 | 62 |
| 2 | 21/21 | 42 |
| 3 | 20/20 | 79 |
| **Итого** | **72/72** | **183** |

---

## [5.0.0] - 2026-01-25

**Стабильная версия** — конфигурация и пайплайн.

- config.py v5.0.0 — централизованная конфигурация
- pipeline.py v5.0.0 — полный пайплайн
- Golden 72/72

---

## [2.0.0] - 2026-01-23

**Восстановление проекта** — после случайного удаления.

Модули:
- pipeline.py, smart_compare.py, golden_filter.py
- text_normalizer.py, transcribe.py
- Тесты/золотой_стандарт_глава1.json

---

## [1.0.0] - До 2026-01-23

Исходная версия: check_transcription.py, filter_errors.py

---

*Сжато: 2026-01-29. Полная версия в архиве.*
